---
export const prerender = true
import Layout from '../../../../layouts/BaseLayout.astro'
import NavCard from '../../../../components/NavCard.astro'
import PageNav from '../../../../components/PageNav.astro'
import { capitaliseAll } from '../../../../components/utils.js'
export async function getStaticPaths({ paginate }) {
	const allBlogs = await Astro.glob('../../*.mdx')
	const uniqueSeries = [...new Set(allBlogs.map((blog) => blog.frontmatter.series).flat())]
	return uniqueSeries.flatMap((series) => {
		const filteredBlogs = allBlogs.filter((blog) => blog.frontmatter.series?.includes(series))
		return paginate(filteredBlogs, {
			params: { series },
			pageSize: 10
		})
	})
}
const { series } = Astro.params

const { page } = Astro.props
const title = capitaliseAll(series)
const description = `The home of my ${capitaliseAll(series)} series.`
const seriesPages = await Astro.glob('../../../../components/series/*.mdx')
const seriesPage = seriesPages.filter((page) => page.frontmatter.series?.includes(series))
const SeriesPageContent = seriesPage[0].Content
const seriesColour = seriesPage[0].frontmatter.seriesColour
---

<Layout title={capitaliseAll(title)} description={description}>
	<SeriesPageContent />
	<ul class="mt-4 grid gap-y-5">
		{page.data.map((blog) => <NavCard post={blog} {seriesColour} />)}
	</ul>
	<PageNav page={page} />
</Layout>
